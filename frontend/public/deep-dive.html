<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Agent Security Deep Dive</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
  <style>
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fadeIn { animation: fadeIn 0.2s ease-out; }
    .mermaid { background: white; border-radius: 12px; padding: 20px; }
  </style>
</head>
<body class="min-h-screen bg-slate-950 text-white">
  
  <!-- Header -->
  <header class="border-b border-slate-800 bg-slate-900/50 sticky top-0 z-50">
    <div class="max-w-6xl mx-auto px-6 py-4 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <h1 class="text-xl font-bold">AI Agent Security Deep Dive</h1>
        <span class="px-2 py-0.5 bg-slate-700 text-slate-300 rounded text-xs font-mono">v8</span>
      </div>
      <div class="flex items-center gap-4">
        <button onclick="expandAll()" class="text-xs text-slate-400 hover:text-white">Expand All</button>
        <span class="text-slate-600">|</span>
        <button onclick="collapseAll()" class="text-xs text-slate-400 hover:text-white">Collapse All</button>
        <span class="px-2 py-1 bg-amber-500/20 text-amber-400 rounded text-xs">Okta + Auth0</span>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-6 py-8">
    <!-- ============================================ -->
    <!-- SECTION 1: THE AI AGENT ERA -->
    <!-- ============================================ -->
    <div id="section1" class="rounded-2xl border border-amber-500/30 bg-amber-900/10 overflow-hidden mb-6">
      <button onclick="toggleSection('section1')" class="w-full p-6 flex items-center justify-between hover:bg-white/5 transition-colors">
        <div class="text-left">
          <h2 class="text-2xl font-bold text-amber-400">The AI Agent Era</h2>
          <p class="text-slate-400 text-sm mt-1">AI adoption is surging. Security and governance have not kept up.</p>
        </div>
        <svg id="section1-chevron" class="w-6 h-6 text-slate-400 transition-transform rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
        </svg>
      </button>
      <div id="section1-content" class="px-6 pb-6 animate-fadeIn">
        
        <!-- Layer 1: Stats Cards -->
        <div class="grid grid-cols-4 gap-4 mb-6">
          <!-- Adoption -->
          <div class="bg-blue-600 rounded-xl p-5">
            <p class="text-xs text-blue-200 mb-2 font-medium uppercase tracking-wide">Adoption</p>
            <div class="text-5xl font-bold text-white mb-2">91%</div>
            <p class="text-sm text-blue-100 mb-3">of organizations now use AI agents in production</p>
            <p class="text-[10px] text-blue-300 border-t border-blue-400/30 pt-2">Okta "AI at Work" Report, 2025</p>
          </div>
          
          <!-- Scale -->
          <div class="bg-purple-600 rounded-xl p-5">
            <p class="text-xs text-purple-200 mb-2 font-medium uppercase tracking-wide">Scale</p>
            <div class="text-5xl font-bold text-white mb-2">100s</div>
            <p class="text-sm text-purple-100 mb-3">of tool calls per conversation across APIs and SaaS</p>
            <p class="text-[10px] text-purple-300 border-t border-purple-400/30 pt-2">Maxim AI, MCP Gateway Guide 2025</p>
          </div>
          
          <!-- Consequence -->
          <div class="bg-slate-800 rounded-xl p-5 border border-slate-700">
            <p class="text-xs text-slate-400 mb-2 font-medium uppercase tracking-wide">Consequence</p>
            <div class="text-5xl font-bold text-orange-400 mb-2">80%</div>
            <p class="text-sm text-slate-300 mb-3">experienced unintended agent behavior in production</p>
            <p class="text-[10px] text-slate-500 border-t border-slate-600 pt-2">The Times "AI Security" Report, 2025</p>
          </div>
          
          <!-- Gap -->
          <div class="bg-slate-800 rounded-xl p-5 border border-slate-700">
            <p class="text-xs text-slate-400 mb-2 font-medium uppercase tracking-wide">Gap</p>
            <div class="text-5xl font-bold text-red-400 mb-2">44%</div>
            <p class="text-sm text-slate-300 mb-3">have no AI agent governance framework in place</p>
            <p class="text-[10px] text-slate-500 border-t border-slate-600 pt-2">The Times "AI Security" Report, 2025</p>
          </div>
        </div>

        <!-- Layer 2: Two Charts -->
        <div class="grid grid-cols-2 gap-6 mb-6">
          <!-- Chart 1: AI Agent Adoption -->
          <div class="bg-slate-800/50 rounded-xl p-5 border border-slate-700">
            <h3 class="text-base font-semibold text-white mb-1">AI Agent Enterprise Adoption</h3>
            <p class="text-xs text-slate-400 mb-6">Organizations using AI agents (%)</p>
            <div class="h-44 flex items-end gap-2">
              <div class="flex-1 flex flex-col items-center">
                <span class="text-[10px] text-amber-400 font-semibold mb-1">1%</span>
                <div class="w-full rounded-t bg-gradient-to-t from-slate-600 to-slate-500" style="height: 1.4px"></div>
                <span class="text-[9px] text-slate-500 mt-2">Q1 24</span>
              </div>
              <div class="flex-1 flex flex-col items-center">
                <span class="text-[10px] text-amber-400 font-semibold mb-1">5%</span>
                <div class="w-full rounded-t bg-gradient-to-t from-slate-600 to-slate-500" style="height: 7px"></div>
                <span class="text-[9px] text-slate-500 mt-2">Q2 24</span>
              </div>
              <div class="flex-1 flex flex-col items-center">
                <span class="text-[10px] text-amber-400 font-semibold mb-1">12%</span>
                <div class="w-full rounded-t bg-gradient-to-t from-slate-600 to-slate-500" style="height: 16.8px"></div>
                <span class="text-[9px] text-slate-500 mt-2">Q3 24</span>
              </div>
              <div class="flex-1 flex flex-col items-center">
                <span class="text-[10px] text-amber-400 font-semibold mb-1">25%</span>
                <div class="w-full rounded-t bg-gradient-to-t from-slate-600 to-slate-500" style="height: 35px"></div>
                <span class="text-[9px] text-slate-500 mt-2">Q4 24</span>
              </div>
              <div class="flex-1 flex flex-col items-center">
                <span class="text-[10px] text-amber-400 font-semibold mb-1">45%</span>
                <div class="w-full rounded-t bg-gradient-to-t from-amber-600 to-amber-400" style="height: 63px"></div>
                <span class="text-[9px] text-slate-500 mt-2">Q1 25</span>
              </div>
              <div class="flex-1 flex flex-col items-center">
                <span class="text-[10px] text-amber-400 font-semibold mb-1">65%</span>
                <div class="w-full rounded-t bg-gradient-to-t from-amber-600 to-amber-400" style="height: 91px"></div>
                <span class="text-[9px] text-slate-500 mt-2">Q2 25</span>
              </div>
              <div class="flex-1 flex flex-col items-center">
                <span class="text-[10px] text-amber-400 font-semibold mb-1">80%</span>
                <div class="w-full rounded-t bg-gradient-to-t from-amber-600 to-amber-400" style="height: 112px"></div>
                <span class="text-[9px] text-slate-500 mt-2">Q3 25</span>
              </div>
              <div class="flex-1 flex flex-col items-center">
                <span class="text-[10px] text-amber-400 font-semibold mb-1">91%</span>
                <div class="w-full rounded-t bg-gradient-to-t from-amber-600 to-amber-400" style="height: 127.4px"></div>
                <span class="text-[9px] text-slate-500 mt-2">Q4 25</span>
              </div>
            </div>
            <div class="flex items-center justify-center gap-6 mt-4 text-[10px]">
              <div class="flex items-center gap-1.5">
                <div class="w-3 h-3 bg-slate-600 rounded"></div>
                <span class="text-slate-400">2024</span>
              </div>
              <div class="flex items-center gap-1.5">
                <div class="w-3 h-3 bg-amber-500 rounded"></div>
                <span class="text-slate-400">2025</span>
              </div>
            </div>
            <p class="text-[10px] text-slate-500 mt-2">Source: Okta AI at Work 2025, Gartner</p>
          </div>

          <!-- Chart 2: MCP Server Growth -->
          <div class="bg-slate-800/50 rounded-xl p-5 border border-slate-700">
            <h3 class="text-base font-semibold text-white mb-1">MCP Server Growth</h3>
            <p class="text-xs text-slate-400 mb-6">100 servers at launch to 6,000+ in one year</p>
            <div class="h-44 flex items-end gap-2 relative">
              <div class="flex-1 flex flex-col items-center relative">
                <div class="absolute bottom-full mb-1 left-1/2 -translate-x-1/2 z-10 text-center">
                  <span class="text-[8px] text-amber-400 font-medium whitespace-nowrap bg-slate-900/90 px-1.5 py-0.5 rounded border border-amber-500/30">Launch</span>
                  <div class="w-px h-2 bg-amber-400/50 mx-auto"></div>
                </div>
                <span class="text-[8px] text-blue-300 mb-1">100</span>
                <div class="w-full bg-gradient-to-t from-blue-600 to-blue-400 rounded-t" style="height: 1.8px"></div>
                <span class="text-[9px] text-slate-500 mt-2">Nov 24</span>
              </div>
              <div class="flex-1 flex flex-col items-center">
                <span class="text-[8px] text-blue-300 mb-1">200</span>
                <div class="w-full bg-gradient-to-t from-blue-600 to-blue-400 rounded-t" style="height: 3.7px"></div>
                <span class="text-[9px] text-slate-500 mt-2">Dec 24</span>
              </div>
              <div class="flex-1 flex flex-col items-center">
                <span class="text-[8px] text-blue-300 mb-1">400</span>
                <div class="w-full bg-gradient-to-t from-blue-600 to-blue-400 rounded-t" style="height: 7.4px"></div>
                <span class="text-[9px] text-slate-500 mt-2">Jan 25</span>
              </div>
              <div class="flex-1 flex flex-col items-center relative">
                <div class="absolute bottom-full mb-1 left-1/2 -translate-x-1/2 z-10 text-center">
                  <span class="text-[8px] text-amber-400 font-medium whitespace-nowrap bg-slate-900/90 px-1.5 py-0.5 rounded border border-amber-500/30">OpenAI</span>
                  <div class="w-px h-2 bg-amber-400/50 mx-auto"></div>
                </div>
                <span class="text-[8px] text-blue-300 mb-1">1.5k</span>
                <div class="w-full bg-gradient-to-t from-blue-600 to-blue-400 rounded-t" style="height: 27.7px"></div>
                <span class="text-[9px] text-slate-500 mt-2">Mar 25</span>
              </div>
              <div class="flex-1 flex flex-col items-center relative">
                <div class="absolute bottom-full mb-1 left-1/2 -translate-x-1/2 z-10 text-center">
                  <span class="text-[8px] text-amber-400 font-medium whitespace-nowrap bg-slate-900/90 px-1.5 py-0.5 rounded border border-amber-500/30">Win 11</span>
                  <div class="w-px h-2 bg-amber-400/50 mx-auto"></div>
                </div>
                <span class="text-[8px] text-blue-300 mb-1">4k</span>
                <div class="w-full bg-gradient-to-t from-blue-600 to-blue-400 rounded-t" style="height: 73.8px"></div>
                <span class="text-[9px] text-slate-500 mt-2">May 25</span>
              </div>
              <div class="flex-1 flex flex-col items-center">
                <span class="text-[8px] text-blue-300 mb-1">5k</span>
                <div class="w-full bg-gradient-to-t from-blue-600 to-blue-400 rounded-t" style="height: 92.3px"></div>
                <span class="text-[9px] text-slate-500 mt-2">Jul 25</span>
              </div>
              <div class="flex-1 flex flex-col items-center relative">
                <div class="absolute bottom-full mb-1 left-1/2 -translate-x-1/2 z-10 text-center">
                  <span class="text-[8px] text-amber-400 font-medium whitespace-nowrap bg-slate-900/90 px-1.5 py-0.5 rounded border border-amber-500/30">Registry</span>
                  <div class="w-px h-2 bg-amber-400/50 mx-auto"></div>
                </div>
                <span class="text-[8px] text-blue-300 mb-1">5.5k</span>
                <div class="w-full bg-gradient-to-t from-blue-600 to-blue-400 rounded-t" style="height: 101.5px"></div>
                <span class="text-[9px] text-slate-500 mt-2">Sep 25</span>
              </div>
              <div class="flex-1 flex flex-col items-center relative">
                <div class="absolute bottom-full mb-1 left-1/2 -translate-x-1/2 z-10 text-center">
                  <span class="text-[8px] text-amber-400 font-medium whitespace-nowrap bg-slate-900/90 px-1.5 py-0.5 rounded border border-amber-500/30">Linux Fdn</span>
                  <div class="w-px h-2 bg-amber-400/50 mx-auto"></div>
                </div>
                <span class="text-[8px] text-blue-300 mb-1">6k</span>
                <div class="w-full bg-gradient-to-t from-blue-600 to-blue-400 rounded-t" style="height: 110.8px"></div>
                <span class="text-[9px] text-slate-500 mt-2">Nov 25</span>
              </div>
            </div>
            <p class="text-[10px] text-slate-500 mt-4">Source: MCP Registry, PulseMCP</p>
          </div>
        </div>

        <!-- Layer 3: McKinsey Quote -->
        <div class="bg-slate-800/30 rounded-xl p-5 border border-slate-700 mb-4">
          <p class="text-lg text-slate-300 text-center">"AI Agents are accessing your enterprise data.</p>
          <p class="text-xl text-amber-400 font-bold text-center mt-1">Who controls them?"</p>
          <p class="text-xs text-slate-500 text-center mt-3">McKinsey "The state of AI in 2025" - November 2025</p>
        </div>

        <!-- Layer 4: Summary Equation -->
        <div class="bg-amber-900/20 rounded-xl p-4 border border-amber-500/30">
          <p class="text-amber-300 text-sm text-center">
            91% adoption x 100s of tool calls + 80% unintended behavior + 44% no governance = <strong>Massive security gap that Okta solves</strong>
          </p>
        </div>
      </div>
    </div>

    <!-- ============================================ -->
    <!-- SECTION 2: SECURITY CHALLENGES (UPDATED) -->
    <!-- ============================================ -->
    <div id="section2" class="rounded-2xl border border-red-500/30 bg-red-900/10 overflow-hidden mb-6">
      <button onclick="toggleSection('section2')" class="w-full p-6 flex items-center justify-between hover:bg-white/5 transition-colors">
        <div class="text-left">
          <h2 class="text-2xl font-bold text-red-400">Common Gaps We're Seeing with Securing AI Agents</h2>
          <p class="text-slate-400 text-sm mt-1">How companies configure agents today vs. what secure agent identity requires</p>
        </div>
        <svg id="section2-chevron" class="w-6 h-6 text-slate-400 transition-transform rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
        </svg>
      </button>
      <div id="section2-content" class="px-6 pb-6 animate-fadeIn">
        
        <!-- Challenge 01: Shadow IT -->
        <div class="bg-slate-900/50 rounded-xl p-5 border border-slate-800 mb-6">
          <div class="flex items-center gap-3 mb-4">
            <span class="text-xl font-bold text-red-400">01</span>
            <h3 class="text-lg font-bold text-white">Shadow IT Connections</h3>
          </div>
          <div class="grid grid-cols-2 gap-4">
            <div class="bg-red-950/30 rounded-lg p-4 border border-red-500/30">
              <p class="text-[10px] font-bold text-red-400 mb-2 uppercase tracking-wide">How It's Done Today</p>
              <p class="text-slate-300 italic mb-3 text-xs leading-relaxed">"Employee connects Claude to Salesforce, Slack, and internal HR system via MCP. IT admin sees Claude login in SSO logs but has zero visibility into downstream tool connections. When the employee leaves, these agent connections persist indefinitely."</p>
              <ul class="space-y-1.5 mb-3">
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-red-400 mt-0.5">✗</span>Agent-to-MCP connections bypass enterprise IdP</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-red-400 mt-0.5">✗</span>No visibility into which tools agents access</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-red-400 mt-0.5">✗</span>No governance over data sharing or tool calls</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-red-400 mt-0.5">✗</span>Orphaned connections persist after employee leaves</li>
              </ul>
              <div class="bg-slate-950 rounded-lg p-2.5 mt-3">
                <pre class="text-[10px] text-red-300 font-mono overflow-x-auto whitespace-pre-wrap">{
  "sub": "claude-desktop-client",
  "aud": "salesforce-mcp",
  "scope": "full-access"
}</pre>
                <p class="text-[9px] text-slate-500 mt-1.5 font-mono">// IdP never sees this connection, cannot revoke</p>
              </div>
            </div>
            <div class="bg-green-950/30 rounded-lg p-4 border border-green-500/30">
              <p class="text-[10px] font-bold text-green-400 mb-2 uppercase tracking-wide">What Should Happen</p>
              <p class="text-slate-300 italic mb-3 text-xs leading-relaxed">"Every agent-to-tool connection flows through the enterprise IdP. IT admin sees and controls all downstream access. When employee leaves, all agent connections are instantly revoked."</p>
              <ul class="space-y-1.5 mb-3">
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-green-400 mt-0.5">✓</span>IdP in the driver's seat for all connections</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-green-400 mt-0.5">✓</span>Full visibility into agent-to-tool access</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-green-400 mt-0.5">✓</span>Centralized policy enforcement</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-green-400 mt-0.5">✓</span>Instant revocation tied to user lifecycle</li>
              </ul>
              <div class="bg-slate-950 rounded-lg p-2.5 mt-3">
                <pre class="text-[10px] text-green-300 font-mono overflow-x-auto whitespace-pre-wrap">{
  "sub": "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="8eefe2e7edebceefede3eba0ede1e3">[email&#160;protected]</a>",
  "act": { "sub": "claude-desktop" },
  "aud": "salesforce-mcp",
  "scope": "opportunities:read",
  "azp": "enterprise-idp"
}</pre>
                <p class="text-[9px] text-slate-500 mt-1.5 font-mono">// IdP controls, logs, and can revoke instantly</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Challenge 02: Overprivileged Access -->
        <div class="bg-slate-900/50 rounded-xl p-5 border border-slate-800 mb-6">
          <div class="flex items-center gap-3 mb-4">
            <span class="text-xl font-bold text-red-400">02</span>
            <h3 class="text-lg font-bold text-white">Overprivileged Access</h3>
          </div>
          <div class="grid grid-cols-2 gap-4">
            <div class="bg-red-950/30 rounded-lg p-4 border border-red-500/30">
              <p class="text-[10px] font-bold text-red-400 mb-2 uppercase tracking-wide">How It's Done Today</p>
              <p class="text-slate-300 italic mb-3 text-xs leading-relaxed">"Sales agent needs to look up one opportunity. It's granted full Salesforce admin access because that's what the service account has. Token is valid for 30 days."</p>
              <ul class="space-y-1.5 mb-3">
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-red-400 mt-0.5">✗</span>Service account with broad permissions</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-red-400 mt-0.5">✗</span>No task-specific scoping</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-red-400 mt-0.5">✗</span>30-day tokens persist after task completes</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-red-400 mt-0.5">✗</span>No way to revoke without breaking other agents</li>
              </ul>
              <div class="bg-slate-950 rounded-lg p-2.5 mt-3">
                <pre class="text-[10px] text-red-300 font-mono overflow-x-auto whitespace-pre-wrap">{
  "sub": "service-account-sales-agent",
  "scope": "salesforce:read salesforce:write salesforce:admin",
  "exp": 1735689600
}</pre>
                <p class="text-[9px] text-slate-500 mt-1.5 font-mono">// 30-day token, full admin, task-blind</p>
              </div>
            </div>
            <div class="bg-green-950/30 rounded-lg p-4 border border-green-500/30">
              <p class="text-[10px] font-bold text-green-400 mb-2 uppercase tracking-wide">What Should Happen</p>
              <p class="text-slate-300 italic mb-3 text-xs leading-relaxed">"Agent requests only the specific permissions needed for this task, scoped to the user's actual access level. Token expires in 5 minutes."</p>
              <ul class="space-y-1.5 mb-3">
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-green-400 mt-0.5">✓</span>Just-in-time token for specific task</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-green-400 mt-0.5">✓</span>Scoped to user's permissions</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-green-400 mt-0.5">✓</span>5-minute TTL, auto-expires</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-green-400 mt-0.5">✓</span>Revocable instantly via IdP</li>
              </ul>
              <div class="bg-slate-950 rounded-lg p-2.5 mt-3">
                <pre class="text-[10px] text-green-300 font-mono overflow-x-auto whitespace-pre-wrap">{
  "sub": "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b4d5d8ddd7d1f4d5d7d9d19ad7dbd9">[email&#160;protected]</a>",
  "act": { "sub": "sales-assistant-agent" },
  "scope": "salesforce:opportunities:read",
  "exp": 1735430700,
  "nbf": 1735430400
}</pre>
                <p class="text-[9px] text-slate-500 mt-1.5 font-mono">// 5-min TTL, scoped, instantly revocable</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Challenge 03: No User Context -->
        <div class="bg-slate-900/50 rounded-xl p-5 border border-slate-800 mb-6">
          <div class="flex items-center gap-3 mb-4">
            <span class="text-xl font-bold text-red-400">03</span>
            <h3 class="text-lg font-bold text-white">No User Context</h3>
          </div>
          <div class="grid grid-cols-2 gap-4">
            <div class="bg-red-950/30 rounded-lg p-4 border border-red-500/30">
              <p class="text-[10px] font-bold text-red-400 mb-2 uppercase tracking-wide">How It's Done Today</p>
              <p class="text-slate-300 italic mb-3 text-xs leading-relaxed">"CFO's agent answers questions in a shared Slack channel. It pulls salary data the CFO can see, but others in the channel cannot. Confidential data leaks to unauthorized viewers."</p>
              <ul class="space-y-1.5 mb-3">
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-red-400 mt-0.5">✗</span>Agent acts as the user who set it up</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-red-400 mt-0.5">✗</span>No awareness of downstream audience</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-red-400 mt-0.5">✗</span>Output may include data others shouldn't see</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-red-400 mt-0.5">✗</span>No way to scope output to channel permissions</li>
              </ul>
              <div class="bg-slate-950 rounded-lg p-2.5 mt-3">
                <pre class="text-[10px] text-red-300 font-mono overflow-x-auto whitespace-pre-wrap">{
  "sub": "service-account-cfo-agent",
  "scope": "slack:read slack:write",
  "aud": "slack-api"
}</pre>
                <p class="text-[9px] text-slate-500 mt-1.5 font-mono">// No user identity, no audience awareness</p>
              </div>
            </div>
            <div class="bg-green-950/30 rounded-lg p-4 border border-green-500/30">
              <p class="text-[10px] font-bold text-green-400 mb-2 uppercase tracking-wide">What Should Happen</p>
              <p class="text-slate-300 italic mb-3 text-xs leading-relaxed">"Agent respects the intersection of permissions for all users who will see its output."</p>
              <ul class="space-y-1.5 mb-3">
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-green-400 mt-0.5">✓</span>Delegated authority with clear "on-behalf-of"</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-green-400 mt-0.5">✓</span>Output scoped to audience permissions</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-green-400 mt-0.5">✓</span>User + agent + action logged separately</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-green-400 mt-0.5">✓</span>"act" claim distinguishes user from agent</li>
              </ul>
              <div class="bg-slate-950 rounded-lg p-2.5 mt-3">
                <pre class="text-[10px] text-green-300 font-mono overflow-x-auto whitespace-pre-wrap">{
  "sub": "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b4d5d8ddd7d1f4d5d7d9d19ad7dbd9">[email&#160;protected]</a>",
  "act": { "sub": "cfo-agent" },
  "aud": ["slack-api", "channel:finance-team"],
  "scope": "slack:read:restricted"
}</pre>
                <p class="text-[9px] text-slate-500 mt-1.5 font-mono">// User-bound, audience-aware, scoped output</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Challenge 04: No Audit Trail -->
        <div class="bg-slate-900/50 rounded-xl p-5 border border-slate-800 mb-6">
          <div class="flex items-center gap-3 mb-4">
            <span class="text-xl font-bold text-red-400">04</span>
            <h3 class="text-lg font-bold text-white">No Audit Trail</h3>
          </div>
          <div class="grid grid-cols-2 gap-4">
            <div class="bg-red-950/30 rounded-lg p-4 border border-red-500/30">
              <p class="text-[10px] font-bold text-red-400 mb-2 uppercase tracking-wide">How It's Done Today</p>
              <p class="text-slate-300 italic mb-3 text-xs leading-relaxed">"HR agent accesses employee records using a shared service account. When a breach occurs, logs show the service account acted but there's no way to trace which user or agent instance was responsible. And no way to revoke just the compromised agent."</p>
              <ul class="space-y-1.5 mb-3">
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-red-400 mt-0.5">✗</span>Service account hides user identity</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-red-400 mt-0.5">✗</span>Actions logged as "service-account"</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-red-400 mt-0.5">✗</span>Incident response is impossible</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-red-400 mt-0.5">✗</span>Cannot revoke one agent without breaking all</li>
              </ul>
              <div class="bg-slate-950 rounded-lg p-2.5 mt-3">
                <pre class="text-[10px] text-red-300 font-mono overflow-x-auto whitespace-pre-wrap">{
  "sub": "service-account-hr-bot",
  "scope": "workday:read workday:write"
}</pre>
                <p class="text-[9px] text-slate-500 mt-1.5 font-mono">// No user attribution, no agent ID, untraceable</p>
              </div>
            </div>
            <div class="bg-green-950/30 rounded-lg p-4 border border-green-500/30">
              <p class="text-[10px] font-bold text-green-400 mb-2 uppercase tracking-wide">What Should Happen</p>
              <p class="text-slate-300 italic mb-3 text-xs leading-relaxed">"Every agent action is logged with user identity, agent identity, and transaction ID. Compromised agent can be surgically revoked without impacting others."</p>
              <ul class="space-y-1.5 mb-3">
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-green-400 mt-0.5">✓</span>User identity preserved in token</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-green-400 mt-0.5">✓</span>Agent identity in "act" claim</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-green-400 mt-0.5">✓</span>Transaction ID (jti) for correlation</li>
                <li class="flex items-start gap-2 text-xs text-slate-400"><span class="text-green-400 mt-0.5">✓</span>Surgical revocation per agent instance</li>
              </ul>
              <div class="bg-slate-950 rounded-lg p-2.5 mt-3">
                <pre class="text-[10px] text-green-300 font-mono overflow-x-auto whitespace-pre-wrap">{
  "sub": "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="dcbdb0b5bfb99cbdbfb1b9f2bfb3b1">[email&#160;protected]</a>",
  "act": { "sub": "hr-assistant-agent" },
  "jti": "txn_8f3k2m1",
  "scope": "workday:employees:read"
}</pre>
                <p class="text-[9px] text-slate-500 mt-1.5 font-mono">// Full audit trail + surgical revocation</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Source Attribution -->
        <div class="p-3 bg-slate-900/30 rounded-lg border border-slate-800">
          <p class="text-[10px] text-slate-500 text-center">
            Based on OpenID Foundation "Identity Management for Agentic AI" (Oct 2025), 
            Aaron Parecki's "Enterprise-Ready MCP", and enterprise security assessments.
          </p>
        </div>
      </div>
    </div>

    <!-- ============================================ -->
    <!-- SECTION 3: User-Delegated vs Workload Identity -->
    <!-- ============================================ -->
    <div id="section3" class="rounded-2xl border border-amber-500/30 bg-amber-900/10 overflow-hidden mb-6">
      <button onclick="toggleSection('section3')" class="w-full p-6 flex items-center justify-between hover:bg-white/5 transition-colors">
        <div class="text-left">
          <h2 class="text-2xl font-bold text-amber-400">User-Delegated vs Workload Identity Access</h2>
          <p class="text-slate-400 text-sm mt-1">Why user context matters for enterprise AI agent security</p>
        </div>
        <svg id="section3-chevron" class="w-6 h-6 text-slate-400 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
        </svg>
      </button>
      <div id="section3-content" class="px-6 pb-6 animate-fadeIn hidden">
        
        <!-- Definition Cards -->
        <div class="grid grid-cols-2 gap-6 mb-6">
          <div class="bg-slate-800/50 rounded-xl p-5 border border-slate-700">
            <h4 class="text-lg font-bold text-slate-300 mb-2">Workload Identity Access</h4>
            <p class="text-sm text-slate-400 mb-3">Agent authenticates as itself. No user context.</p>
            <ul class="space-y-1 text-xs text-slate-500">
              <li>• Machine-to-machine credentials</li>
              <li>• Shared workload identity with broad permissions</li>
              <li>• No visibility into which user triggered the action</li>
              <li>• Example: Agent calls GitHub using a shared workload account</li>
            </ul>
          </div>
          <div class="bg-amber-900/20 rounded-xl p-5 border border-amber-500/30">
            <h4 class="text-lg font-bold text-amber-400 mb-2">User-Delegated Access</h4>
            <p class="text-sm text-slate-400 mb-3">Agent acts on behalf of a specific user.</p>
            <ul class="space-y-1 text-xs text-slate-400">
              <li>• User identity preserved in every request</li>
              <li>• Agent inherits user's permissions (not more)</li>
              <li>• Full audit trail: who triggered what, when</li>
              <li>• Example: Agent calls GitHub as Sarah, with Sarah's repos only</li>
            </ul>
          </div>
        </div>

        <!-- Side by Side Flow Comparison -->
        <div class="grid grid-cols-2 gap-6 mb-6">
          
          <!-- Workload Identity Flow -->
          <div class="bg-red-950/20 rounded-xl p-5 border border-red-500/30">
            <div class="flex items-center gap-2 mb-4">
              <div class="w-6 h-6 bg-red-500 rounded-full flex items-center justify-center">
                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M6 18L18 6M6 6l12 12" />
                </svg>
              </div>
              <h4 class="font-semibold text-red-400">Workload Identity Flow</h4>
            </div>
            
            <!-- Flow Diagram -->
            <div class="flex items-center justify-between gap-2 mb-4">
              <div class="bg-slate-800 rounded-lg p-3 text-center flex-1">
                <p class="text-xs text-blue-400 font-medium">Agent</p>
              </div>
              <div class="text-slate-500">→</div>
              <div class="bg-slate-800 rounded-lg p-3 text-center flex-1">
                <p class="text-xs text-slate-400 font-medium">Workload Token</p>
              </div>
              <div class="text-slate-500">→</div>
              <div class="bg-slate-800 rounded-lg p-3 text-center flex-1">
                <p class="text-xs text-green-400 font-medium">SaaS API</p>
              </div>
            </div>
            
            <!-- Result -->
            <div class="bg-red-900/30 rounded-lg p-3 border border-red-500/20">
              <p class="text-xs font-bold text-red-400 mb-2">Result: No user context</p>
              <ul class="space-y-1 text-[10px] text-red-300">
                <li>✗ API sees "workload-account", not the user</li>
                <li>✗ Broad permissions (access everything)</li>
                <li>✗ Long-lived tokens (days/weeks)</li>
                <li>✗ No per-user audit trail</li>
                <li>✗ Cannot revoke access for one user</li>
              </ul>
            </div>
          </div>

          <!-- User-Delegated Flow -->
          <div class="bg-green-950/20 rounded-xl p-5 border border-green-500/30">
            <div class="flex items-center gap-2 mb-4">
              <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center">
                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7" />
                </svg>
              </div>
              <h4 class="font-semibold text-green-400">User-Delegated Flow</h4>
            </div>
            
            <!-- Flow Diagram -->
            <div class="flex items-center justify-between gap-2 mb-4">
              <div class="bg-slate-800 rounded-lg p-3 text-center flex-1">
                <p class="text-xs text-blue-400 font-medium">Agent</p>
              </div>
              <div class="text-slate-500">→</div>
              <div class="bg-blue-900/50 rounded-lg p-3 text-center flex-1 border border-blue-500/50">
                <p class="text-xs text-blue-400 font-medium">Okta XAA</p>
              </div>
              <div class="text-slate-500">→</div>
              <div class="bg-slate-800 rounded-lg p-3 text-center flex-1">
                <p class="text-xs text-green-400 font-medium">SaaS API</p>
              </div>
            </div>
            
            <!-- Result -->
            <div class="bg-green-900/30 rounded-lg p-3 border border-green-500/20">
              <p class="text-xs font-bold text-green-400 mb-2">Result: Full user context</p>
              <ul class="space-y-1 text-[10px] text-green-300">
                <li>✓ API sees "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="badbd6d3d9dffadbd9d7df94d9d5d7">[email&#160;protected]</a> via agent"</li>
                <li>✓ Scoped to user's actual permissions</li>
                <li>✓ Short-lived tokens (5 min TTL)</li>
                <li>✓ Complete audit trail per user</li>
                <li>✓ Instantly revocable per user/agent</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Key Insight Box -->
        <div class="bg-amber-900/20 rounded-xl p-5 border border-amber-500/30">
          <h4 class="text-sm font-bold text-amber-400 mb-3">The Key Difference</h4>
          <div class="grid grid-cols-2 gap-4">
            <div class="text-center p-3 bg-red-950/30 rounded-lg border border-red-500/20">
              <p class="text-sm text-red-400 font-medium">"Agent has god-mode API access"</p>
              <p class="text-[10px] text-slate-500 mt-1">Workload Identity: No user context</p>
            </div>
            <div class="text-center p-3 bg-green-950/30 rounded-lg border border-green-500/20">
              <p class="text-sm text-green-400 font-medium">"Agent acts as the user, with user's permissions"</p>
              <p class="text-[10px] text-slate-500 mt-1">User-Delegated: Full user context via Okta</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ============================================ -->

    <!-- ============================================ -->
    <!-- SECTION 4: OKTA FOR AI AGENTS SOLUTION -->
    <!-- ============================================ -->
    <div id="section4" class="rounded-2xl border border-blue-500/30 bg-gradient-to-br from-blue-900/20 to-slate-900 overflow-hidden mb-6">
      <button onclick="toggleSection('section4')" class="w-full p-6 flex items-center justify-between hover:bg-white/5 transition-colors">
        <div class="text-left">
          <h2 class="text-2xl font-bold text-blue-400">Okta for AI Agents: Complete Agentic Security Stack</h2>
          <p class="text-slate-400 text-sm mt-1">Discover → Onboard & Configure → Protect → Any Resource</p>
        </div>
        <svg id="section4-chevron" class="w-6 h-6 text-slate-400 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
        </svg>
      </button>
      <div id="section4-content" class="px-6 pb-6 animate-fadeIn hidden">

        <!-- Security Stack Flow Diagram - Pure CSS -->
        <div class="bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 rounded-2xl p-8 mb-6 border border-slate-700">
          
          <!-- Main Flow -->
          <div class="flex items-stretch gap-3">
            
            <!-- Any AI Agent -->
            <div class="w-44 bg-slate-800/80 rounded-xl p-4 border border-slate-600">
              <p class="text-sm font-bold text-white mb-3">Any AI Agent</p>
              <div class="space-y-2">
                <div class="bg-slate-700/50 rounded px-2 py-1.5 text-xs text-slate-300">LLM Assistants</div>
                <div class="bg-slate-700/50 rounded px-2 py-1.5 text-xs text-slate-300">Platform Agents</div>
                <div class="bg-slate-700/50 rounded px-2 py-1.5 text-xs text-slate-300">Purpose-Built</div>
                <div class="bg-slate-700/50 rounded px-2 py-1.5 text-xs text-slate-300">Custom Builds</div>
              </div>
            </div>

            <!-- Arrow 1 -->
            <div class="flex items-center">
              <div class="w-8 h-0.5 bg-gradient-to-r from-slate-500 to-blue-500"></div>
              <div class="w-0 h-0 border-t-4 border-b-4 border-l-6 border-transparent border-l-blue-500"></div>
            </div>

            <!-- 1. Discover -->
            <div class="flex-1 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl p-4 shadow-lg shadow-blue-500/20">
              <div class="flex items-center gap-2 mb-3">
                <div class="w-7 h-7 bg-white/20 rounded-full flex items-center justify-center text-white text-sm font-bold">1</div>
                <div>
                  <p class="text-sm font-bold text-white">Discover</p>
                  <p class="text-[10px] text-blue-200">Agent Discovery</p>
                </div>
              </div>
              <ul class="space-y-1.5 text-xs text-blue-100">
                <li>• Known agent platforms</li>
                <li>• Shadow unsanctioned</li>
                <li>• Service accounts & NHIs</li>
                <li>• Tag risk score</li>
              </ul>
            </div>

            <!-- Arrow 2 -->
            <div class="flex items-center">
              <div class="w-8 h-0.5 bg-gradient-to-r from-blue-500 to-purple-500"></div>
              <div class="w-0 h-0 border-t-4 border-b-4 border-l-6 border-transparent border-l-purple-500"></div>
            </div>

            <!-- 2. Onboard & Configure -->
            <div class="flex-1 bg-gradient-to-br from-purple-600 to-purple-700 rounded-xl p-4 shadow-lg shadow-purple-500/20">
              <div class="flex items-center gap-2 mb-3">
                <div class="w-7 h-7 bg-white/20 rounded-full flex items-center justify-center text-white text-sm font-bold">2</div>
                <div>
                  <p class="text-sm font-bold text-white">Onboard & Configure</p>
                  <p class="text-[10px] text-purple-200">Agent Registry + Lifecycle</p>
                </div>
              </div>
              <ul class="space-y-1.5 text-xs text-purple-100">
                <li>• Register in Universal Directory</li>
                <li>• Assign owners</li>
                <li>• Governance (access cert)</li>
                <li>• Lifecycle management</li>
              </ul>
            </div>

            <!-- Arrow 3 -->
            <div class="flex items-center">
              <div class="w-8 h-0.5 bg-gradient-to-r from-purple-500 to-green-500"></div>
              <div class="w-0 h-0 border-t-4 border-b-4 border-l-6 border-transparent border-l-green-500"></div>
            </div>

            <!-- 3. Protect -->
            <div class="flex-1 bg-gradient-to-br from-green-600 to-green-700 rounded-xl p-4 shadow-lg shadow-green-500/20">
              <div class="flex items-center gap-2 mb-3">
                <div class="w-7 h-7 bg-white/20 rounded-full flex items-center justify-center text-white text-sm font-bold">3</div>
                <div>
                  <p class="text-sm font-bold text-white">Protect</p>
                  <p class="text-[10px] text-green-200">AI Security Gateway</p>
                </div>
              </div>
              <div class="grid grid-cols-2 gap-x-2 text-xs text-green-100">
                <ul class="space-y-1.5">
                  <li>• Token Vault</li>
                  <li>• FGA / OPA</li>
                  <li>• Universal Logout</li>
                </ul>
                <ul class="space-y-1.5">
                  <li>• Token Exchange</li>
                  <li>• CIBA</li>
                  <li>• Telemetry</li>
                </ul>
              </div>
            </div>

            <!-- Arrow 4 -->
            <div class="flex items-center">
              <div class="w-8 h-0.5 bg-gradient-to-r from-green-500 to-slate-500"></div>
              <div class="w-0 h-0 border-t-4 border-b-4 border-l-6 border-transparent border-l-slate-400"></div>
            </div>

            <!-- Any Resource -->
            <div class="w-44 bg-slate-800/80 rounded-xl p-4 border border-slate-600">
              <p class="text-sm font-bold text-white mb-3">Any Resource</p>
              <div class="space-y-2">
                <div class="bg-slate-700/50 rounded px-2 py-1.5 text-xs text-slate-300">External SaaS</div>
                <div class="bg-slate-700/50 rounded px-2 py-1.5 text-xs text-slate-300">External MCP</div>
                <div class="bg-slate-700/50 rounded px-2 py-1.5 text-xs text-slate-300">Internal MCP</div>
                <div class="bg-slate-700/50 rounded px-2 py-1.5 text-xs text-slate-300">Internal APIs</div>
              </div>
            </div>

          </div>

          <!-- Continuous Discovery Footer -->
          <div class="mt-6 bg-blue-500/10 border border-blue-500/30 rounded-lg p-3 text-center">
            <p class="text-sm text-blue-300">
              <span class="font-semibold">↻ Continuous Discovery:</span> 
              Scan for new shadow agents and feed back to Registry
            </p>
          </div>
        </div>

        <!-- Three Sub-sections -->
        <div class="space-y-4">
          
          <!-- SUB-SECTION 4.1: Agent Registry & Managed Connections -->
          <div id="section4-1" class="rounded-xl border border-slate-700 bg-slate-800/50 overflow-hidden">
            <button onclick="toggleSection('section4-1')" class="w-full p-4 flex items-center justify-between hover:bg-white/5 transition-colors">
              <div class="text-left flex items-center gap-3">
                <span class="px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-sm font-bold">4.1</span>
                <div>
                  <h3 class="text-lg font-semibold text-white">Agent Registry & Managed Connections</h3>
                  <p class="text-slate-400 text-xs">How agents are registered in Okta with MCP Authorization Servers</p>
                </div>
              </div>
              <svg id="section4-1-chevron" class="w-5 h-5 text-slate-400 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </button>
            <div id="section4-1-content" class="px-4 pb-4 animate-fadeIn hidden">
              
              <!-- Architecture Diagram - Pure CSS -->
              <div class="bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 rounded-xl p-6 mb-4 border border-slate-700">
                <p class="text-xs text-slate-400 mb-4 text-center">Token Vault Architecture with Okta + Auth0</p>
                
                <div class="flex items-center justify-between gap-4">
                  <!-- Workforce IdP -->
                  <div class="text-center">
                    <div class="w-28 h-20 bg-blue-600 rounded-lg flex items-center justify-center mb-2 shadow-lg">
                      <div>
                        <p class="text-xs font-bold text-white">Workforce IdP</p>
                        <p class="text-[10px] text-blue-200">Okta</p>
                      </div>
                    </div>
                  </div>

                  <!-- Arrows -->
                  <div class="flex flex-col gap-2 text-[10px] text-slate-400">
                    <div class="flex items-center gap-1">
                      <span>SSO</span>
                      <div class="w-12 h-px bg-slate-500"></div>
                      <span>→</span>
                    </div>
                  </div>

                  <!-- AI Agent -->
                  <div class="text-center">
                    <div class="w-32 h-20 bg-purple-600 rounded-lg flex items-center justify-center mb-2 shadow-lg">
                      <div>
                        <p class="text-xs font-bold text-white">AI Agent</p>
                        <p class="text-[10px] text-purple-200">id_token, refresh</p>
                      </div>
                    </div>
                  </div>

                  <!-- Arrow -->
                  <div class="flex flex-col gap-2 text-[10px] text-slate-400">
                    <div class="flex items-center gap-1">
                      <span>Okta Token</span>
                      <div class="w-8 h-px bg-slate-500"></div>
                      <span>→</span>
                    </div>
                  </div>

                  <!-- Token Vault -->
                  <div class="text-center">
                    <div class="w-32 h-20 bg-amber-600 rounded-lg flex items-center justify-center mb-2 shadow-lg">
                      <div>
                        <p class="text-xs font-bold text-white">Token Vault</p>
                        <p class="text-[10px] text-amber-200">Auth0</p>
                      </div>
                    </div>
                  </div>

                  <!-- Arrow -->
                  <div class="flex flex-col gap-2 text-[10px] text-slate-400">
                    <div class="flex items-center gap-1">
                      <span>Scoped</span>
                      <div class="w-8 h-px bg-slate-500"></div>
                      <span>→</span>
                    </div>
                  </div>

                  <!-- Resources -->
                  <div class="flex flex-col gap-2">
                    <div class="w-24 h-8 bg-green-600/80 rounded flex items-center justify-center">
                      <p class="text-[10px] font-medium text-white">Internal API</p>
                    </div>
                    <div class="w-24 h-8 bg-green-600/80 rounded flex items-center justify-center">
                      <p class="text-[10px] font-medium text-white">GitHub MCP</p>
                    </div>
                    <div class="w-24 h-8 bg-green-600/80 rounded flex items-center justify-center">
                      <p class="text-[10px] font-medium text-white">Google API</p>
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="grid grid-cols-2 gap-4">
                <div class="bg-slate-800 rounded-lg p-4 border border-slate-700">
                  <h5 class="text-sm font-bold text-blue-400 mb-3">Agent Registration in Okta</h5>
                  <ul class="space-y-2 text-sm text-slate-300">
                    <li class="flex items-start gap-2"><span class="text-blue-400 mt-1">•</span> Register agent as application in Universal Directory</li>
                    <li class="flex items-start gap-2"><span class="text-blue-400 mt-1">•</span> Assign owner (individual or group)</li>
                    <li class="flex items-start gap-2"><span class="text-blue-400 mt-1">•</span> Define allowed scopes and resources</li>
                    <li class="flex items-start gap-2"><span class="text-blue-400 mt-1">•</span> Configure lifecycle policies</li>
                  </ul>
                </div>
                <div class="bg-slate-800 rounded-lg p-4 border border-slate-700">
                  <h5 class="text-sm font-bold text-purple-400 mb-3">Managed Connections</h5>
                  <ul class="space-y-2 text-sm text-slate-300">
                    <li class="flex items-start gap-2"><span class="text-purple-400 mt-1">•</span> MCP Auth Servers defined in Okta</li>
                    <li class="flex items-start gap-2"><span class="text-purple-400 mt-1">•</span> Admin pre-approves agent ↔ resource access</li>
                    <li class="flex items-start gap-2"><span class="text-purple-400 mt-1">•</span> No user consent popups in enterprise</li>
                    <li class="flex items-start gap-2"><span class="text-purple-400 mt-1">•</span> Instant revocation across all connections</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          
          <!-- SUB-SECTION 4.2: Cross-App Access (XAA) -->
          <div id="section4-2" class="rounded-xl border border-slate-700 bg-slate-800/50 overflow-hidden">
            <button onclick="toggleSection('section4-2')" class="w-full p-4 flex items-center justify-between hover:bg-white/5 transition-colors">
              <div class="text-left flex items-center gap-3">
                <span class="px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-sm font-bold">4.2</span>
                <div>
                  <h3 class="text-lg font-semibold text-white">Cross-App Access (XAA)</h3>
                  <p class="text-slate-400 text-xs">Token exchange for internal MCP and external SaaS via Token Vault</p>
                </div>
              </div>
              <svg id="section4-2-chevron" class="w-5 h-5 text-slate-400 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </button>
            <div id="section4-2-content" class="px-4 pb-4 animate-fadeIn hidden">
              
              <p class="text-sm text-slate-400 mb-4">
                XAA enables secure token exchange where the IdP remains in control. Used for <strong class="text-green-400">internal MCP servers</strong> (direct access) 
                AND <strong class="text-purple-400">external SaaS</strong> (via Token Vault).
              </p>
              
              <!-- XAA Flow - Mermaid Sequence Diagram -->
              <div class="bg-white rounded-xl p-4 mb-4">
                <div class="mermaid">
sequenceDiagram
    participant User
    participant Agent as AI Agent
    participant Okta
    participant MCP as Internal MCP
    participant TV as Token Vault
    participant Google as Google Calendar

    Note over User,Google: XAA for Internal MCP
    User->>Agent: 1. Login via Okta SSO
    Agent->>Okta: 2. Get ID Token
    Okta-->>Agent: 3. ID Token (user: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="23424f4a40466342404e460d404c4e">[email&#160;protected]</a>)
    Agent->>Okta: 4. Exchange for ID-JAG
    Okta-->>Agent: 5. ID-JAG (user-bound, 5min TTL)
    Agent->>MCP: 6. Call tool with ID-JAG
    MCP-->>Agent: 7. Portfolio data

    Note over User,Google: XAA for External SaaS
    Agent->>Okta: 8. Request vault token
    Okta-->>Agent: 9. Vault access token
    Agent->>TV: 10. Exchange for Google token
    TV-->>Agent: 11. Scoped Google token
    Agent->>Google: 12. Call Calendar API
    Google-->>Agent: 13. Calendar events
                </div>
              </div>
              
              <!-- XAA Flow Steps - CSS -->
              <div class="bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 rounded-xl p-6 mb-4 border border-slate-700">
                <p class="text-xs text-slate-400 mb-4">XAA Token Exchange Flow</p>
                <div class="space-y-3">
                  <div class="flex items-center gap-3">
                    <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-bold shrink-0">1</div>
                    <div class="flex-1 bg-slate-800 rounded-lg p-3 border border-slate-700">
                      <p class="text-sm text-slate-300">User logs in via <span class="text-blue-400 font-medium">Okta SSO</span> → Agent receives <span class="text-green-400 font-medium">ID Token</span></p>
                    </div>
                  </div>
                  <div class="flex items-center gap-3">
                    <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center text-white text-xs font-bold shrink-0">2</div>
                    <div class="flex-1 bg-slate-800 rounded-lg p-3 border border-slate-700">
                      <p class="text-sm text-slate-300">Agent exchanges ID Token for <span class="text-purple-400 font-medium">ID-JAG</span> (user-bound, 5min TTL, scoped)</p>
                    </div>
                  </div>
                  <div class="flex items-center gap-3">
                    <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center text-white text-xs font-bold shrink-0">3</div>
                    <div class="flex-1 bg-slate-800 rounded-lg p-3 border border-slate-700">
                      <p class="text-sm text-slate-300">Call <span class="text-green-400 font-medium">Internal MCP</span> with ID-JAG → Get portfolio data, transactions, etc.</p>
                    </div>
                  </div>
                  <div class="flex items-center gap-3">
                    <div class="w-8 h-8 bg-amber-500 rounded-full flex items-center justify-center text-white text-xs font-bold shrink-0">4</div>
                    <div class="flex-1 bg-slate-800 rounded-lg p-3 border border-slate-700">
                      <p class="text-sm text-slate-300">For external SaaS: Exchange via <span class="text-amber-400 font-medium">Token Vault</span> → Get Google Calendar, Salesforce, etc.</p>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- ID-JAG Token Properties -->
              <div class="grid grid-cols-5 gap-2 mb-4">
                <div class="bg-blue-500/20 border border-blue-500/30 rounded-lg p-3 text-center">
                  <p class="text-xs font-bold text-blue-400">User-bound</p>
                  <p class="text-[10px] text-slate-400 mt-1"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6504090c060025040608004b060a08">[email&#160;protected]</a></p>
                </div>
                <div class="bg-purple-500/20 border border-purple-500/30 rounded-lg p-3 text-center">
                  <p class="text-xs font-bold text-purple-400">Time-bound</p>
                  <p class="text-[10px] text-slate-400 mt-1">5 min TTL</p>
                </div>
                <div class="bg-green-500/20 border border-green-500/30 rounded-lg p-3 text-center">
                  <p class="text-xs font-bold text-green-400">Well-scoped</p>
                  <p class="text-[10px] text-slate-400 mt-1">mcp:read only</p>
                </div>
                <div class="bg-amber-500/20 border border-amber-500/30 rounded-lg p-3 text-center">
                  <p class="text-xs font-bold text-amber-400">DPoP-bound</p>
                  <p class="text-[10px] text-slate-400 mt-1">Crypto proof</p>
                </div>
                <div class="bg-red-500/20 border border-red-500/30 rounded-lg p-3 text-center">
                  <p class="text-xs font-bold text-red-400">Revocable</p>
                  <p class="text-[10px] text-slate-400 mt-1">One click</p>
                </div>
              </div>
              
              <!-- Aaron Parecki quote -->
              <div class="bg-blue-900/20 rounded-lg p-4 border-l-4 border-blue-500">
                <p class="text-sm text-slate-300 italic mb-2">
                  "Cross-App Access provides IT admins better visibility and control of app-to-app connections 
                  by configuring the connections in their enterprise IdP."
                </p>
                <p class="text-xs text-slate-500">— Aaron Parecki, Director of Identity Standards, Okta</p>
              </div>
            </div>
          </div>
          
          <!-- SUB-SECTION 4.3: Auth0 Token Vault -->
          <div id="section4-3" class="rounded-xl border border-slate-700 bg-slate-800/50 overflow-hidden">
            <button onclick="toggleSection('section4-3')" class="w-full p-4 flex items-center justify-between hover:bg-white/5 transition-colors">
              <div class="text-left flex items-center gap-3">
                <span class="px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-sm font-bold">4.3</span>
                <div>
                  <h3 class="text-lg font-semibold text-white">Auth0 Token Vault</h3>
                  <p class="text-slate-400 text-xs">Secure credential storage for external SaaS (Google, GitHub, Salesforce)</p>
                </div>
              </div>
              <svg id="section4-3-chevron" class="w-5 h-5 text-slate-400 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </button>
            <div id="section4-3-content" class="px-4 pb-4 animate-fadeIn hidden">
              
              <p class="text-sm text-slate-400 mb-4">
                Token Vault stores real OAuth tokens for external SaaS. Agents never see the actual credentials - 
                they receive short-lived, scoped tokens that the Vault proxies on their behalf.
              </p>
              
              <!-- Token Vault Flow - Mermaid Sequence Diagram -->
              <div class="bg-white rounded-xl p-4 mb-4">
                <div class="mermaid">
sequenceDiagram
    participant Agent as AI Agent
    participant Okta
    participant TV as Auth0 Token Vault
    participant Google as Google Calendar API

    Note over Agent,Google: 2-Step Token Exchange
    Agent->>Okta: 1. Present Okta access token
    Okta->>TV: 2. Token exchange request
    TV-->>Okta: 3. Vault token (connection-scoped)
    Okta-->>Agent: 4. Return vault token
    
    Agent->>TV: 5. Request Google token
    Note right of TV: Real Google token<br/>stored securely
    TV->>Google: 6. Proxy API call
    Google-->>TV: 7. Calendar data
    TV-->>Agent: 8. Return data (not token)
                </div>
              </div>
              
              <!-- Token Vault 2-Step Flow - CSS -->
              <div class="bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 rounded-xl p-6 mb-4 border border-slate-700">
                <p class="text-xs text-slate-400 mb-4">2-Step Token Exchange via Token Vault</p>
                <div class="grid grid-cols-2 gap-6">
                  <div class="bg-slate-800 rounded-lg p-4 border border-purple-500/30">
                    <div class="flex items-center gap-2 mb-3">
                      <div class="w-6 h-6 bg-purple-500 rounded-full flex items-center justify-center text-white text-xs font-bold">1</div>
                      <p class="text-sm font-bold text-purple-400">Okta → Vault Token</p>
                    </div>
                    <div class="flex items-center gap-2 text-xs">
                      <div class="bg-blue-600 rounded px-2 py-1 text-white">Okta Token</div>
                      <span class="text-slate-400">→</span>
                      <div class="bg-amber-600 rounded px-2 py-1 text-white">Vault Token</div>
                    </div>
                    <p class="text-[10px] text-slate-500 mt-2">Exchange Okta access token for vault-scoped token</p>
                  </div>
                  <div class="bg-slate-800 rounded-lg p-4 border border-green-500/30">
                    <div class="flex items-center gap-2 mb-3">
                      <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white text-xs font-bold">2</div>
                      <p class="text-sm font-bold text-green-400">Vault → SaaS Token</p>
                    </div>
                    <div class="flex items-center gap-2 text-xs">
                      <div class="bg-amber-600 rounded px-2 py-1 text-white">Vault Token</div>
                      <span class="text-slate-400">→</span>
                      <div class="bg-green-600 rounded px-2 py-1 text-white">Google Token</div>
                    </div>
                    <p class="text-[10px] text-slate-500 mt-2">Vault returns scoped SaaS token (or proxies request)</p>
                  </div>
                </div>
                <div class="mt-4 bg-green-500/10 border border-green-500/30 rounded-lg p-3 text-center">
                  <p class="text-xs text-green-300 font-medium">✓ Real Google token NEVER exposed to agent</p>
                </div>
              </div>
              
              <!-- 4-Step Explanation -->
              <div class="grid grid-cols-4 gap-3 mb-4">
                <div class="bg-slate-800 rounded-lg p-3 border border-slate-700">
                  <div class="w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-bold mb-2">1</div>
                  <p class="text-xs font-bold text-blue-400 mb-1">User Links Account</p>
                  <p class="text-[10px] text-slate-400">One-time OAuth flow. Real token stored in Vault.</p>
                </div>
                <div class="bg-slate-800 rounded-lg p-3 border border-slate-700">
                  <div class="w-6 h-6 bg-purple-500 rounded-full flex items-center justify-center text-white text-xs font-bold mb-2">2</div>
                  <p class="text-xs font-bold text-purple-400 mb-1">Agent Gets Virtual Token</p>
                  <p class="text-[10px] text-slate-400">Short-lived, scoped token for Vault access only.</p>
                </div>
                <div class="bg-slate-800 rounded-lg p-3 border border-slate-700">
                  <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white text-xs font-bold mb-2">3</div>
                  <p class="text-xs font-bold text-green-400 mb-1">Vault Proxies Request</p>
                  <p class="text-[10px] text-slate-400">Real token used server-side. Agent never sees it.</p>
                </div>
                <div class="bg-slate-800 rounded-lg p-3 border border-slate-700">
                  <div class="w-6 h-6 bg-amber-500 rounded-full flex items-center justify-center text-white text-xs font-bold mb-2">4</div>
                  <p class="text-xs font-bold text-amber-400 mb-1">Lifecycle Managed</p>
                  <p class="text-[10px] text-slate-400">Refresh, revoke, audit - all centralized.</p>
                </div>
              </div>
              
              <!-- With vs Without -->
              <div class="grid grid-cols-2 gap-4">
                <div class="bg-red-950/30 rounded-lg p-4 border border-red-500/30">
                  <h5 class="text-sm font-bold text-red-400 mb-3 flex items-center gap-2">
                    <span class="text-lg">✗</span> Without Token Vault
                  </h5>
                  <ul class="space-y-2 text-sm text-red-300">
                    <li>• Agent stores Google refresh token directly</li>
                    <li>• Compromised agent = stolen credentials</li>
                    <li>• No visibility into token usage</li>
                    <li>• Manual revocation across all agents</li>
                  </ul>
                </div>
                <div class="bg-green-950/30 rounded-lg p-4 border border-green-500/30">
                  <h5 class="text-sm font-bold text-green-400 mb-3 flex items-center gap-2">
                    <span class="text-lg">✓</span> With Token Vault
                  </h5>
                  <ul class="space-y-2 text-sm text-green-300">
                    <li>• Agent never holds real credentials</li>
                    <li>• Compromised agent = nothing to steal</li>
                    <li>• Full audit trail of every API call</li>
                    <li>• One-click revocation for any user/agent</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          
        </div>
      </div>
    </div>

    <!-- ============================================ -->
    <!-- SECTION 5: HOW APEX WORKS -->
    <!-- ============================================ -->
    <div id="section5" class="rounded-2xl border border-green-500/30 bg-gradient-to-br from-green-900/20 to-slate-900 overflow-hidden mb-6">
      <button onclick="toggleSection('section5')" class="w-full p-6 flex items-center justify-between hover:bg-white/5 transition-colors">
        <div class="text-left">
          <h2 class="text-2xl font-bold text-green-400">How Apex Wealth Advisor Works</h2>
          <p class="text-slate-400 text-sm mt-1">Live demo: XAA for internal MCP, Token Vault for Google Calendar</p>
        </div>
        <svg id="section5-chevron" class="w-6 h-6 text-slate-400 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
        </svg>
      </button>
      <div id="section5-content" class="px-6 pb-6 animate-fadeIn hidden">
        
        <!-- Block Architecture Diagram -->
        <div class="bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 rounded-xl p-6 border border-slate-700 mb-6">
          <p class="text-sm font-semibold text-white mb-6 text-center">Apex Wealth Advisor Architecture</p>
          
          <div class="flex items-center justify-between gap-4">
            <!-- User -->
            <div class="text-center">
              <div class="w-24 h-24 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center mb-2 shadow-lg">
                <div>
                  <svg class="w-10 h-10 mx-auto text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                  </svg>
                  <p class="text-xs text-white font-medium mt-1">User</p>
                </div>
              </div>
              <p class="text-[10px] text-slate-500">Wealth Advisor</p>
            </div>
            
            <div class="text-slate-500">→</div>
            
            <!-- Frontend -->
            <div class="text-center">
              <div class="w-24 h-24 bg-gradient-to-br from-amber-500 to-amber-600 rounded-xl flex items-center justify-center mb-2 shadow-lg">
                <div>
                  <p class="text-white font-bold">Next.js</p>
                  <p class="text-[10px] text-amber-200">Frontend</p>
                </div>
              </div>
              <p class="text-[10px] text-slate-500">Vercel</p>
            </div>
            
            <div class="text-slate-500">→</div>
            
            <!-- Okta -->
            <div class="text-center">
              <div class="w-24 h-24 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center mb-2 shadow-lg ring-2 ring-blue-400">
                <div>
                  <svg class="w-10 h-10 mx-auto text-white" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 0C5.389 0 0 5.389 0 12s5.389 12 12 12 12-5.389 12-12S18.611 0 12 0zm0 18c-3.314 0-6-2.686-6-6s2.686-6 6-6 6 2.686 6 6-2.686 6-6 6z"/>
                  </svg>
                  <p class="text-xs text-white font-bold mt-1">Okta</p>
                </div>
              </div>
              <p class="text-[10px] text-slate-500">IdP + XAA</p>
            </div>
            
            <div class="text-slate-500">→</div>
            
            <!-- Backend -->
            <div class="text-center">
              <div class="w-24 h-24 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center mb-2 shadow-lg">
                <div>
                  <p class="text-white font-bold">FastAPI</p>
                  <p class="text-[10px] text-purple-200">+ Claude AI</p>
                </div>
              </div>
              <p class="text-[10px] text-slate-500">Render</p>
            </div>
            
            <div class="text-slate-500">→</div>
            
            <!-- MCP Server -->
            <div class="text-center">
              <div class="w-24 h-24 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center mb-2 shadow-lg">
                <div>
                  <p class="text-white font-bold">Apex MCP</p>
                  <p class="text-[10px] text-green-200">Server</p>
                </div>
              </div>
              <p class="text-[10px] text-slate-500">Tools API</p>
            </div>
          </div>
        </div>

        <!-- Tools Grid -->
        <div class="grid grid-cols-2 gap-6 mb-6">
          <!-- Internal Tools -->
          <div class="bg-green-900/20 rounded-xl p-5 border border-green-500/30">
            <h5 class="text-green-400 font-semibold mb-4 flex items-center gap-2">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
              </svg>
              Internal Tools (via XAA)
            </h5>
            <ul class="space-y-2 text-sm text-slate-300">
              <li class="flex items-center gap-2"><span class="text-green-400">•</span> get_portfolio - Client portfolio data</li>
              <li class="flex items-center gap-2"><span class="text-green-400">•</span> list_clients - Search client database</li>
              <li class="flex items-center gap-2"><span class="text-green-400">•</span> get_transactions - Transaction history</li>
              <li class="flex items-center gap-2"><span class="text-green-400">•</span> initiate_payment - Wire transfers</li>
            </ul>
          </div>
          
          <!-- External Tools -->
          <div class="bg-purple-900/20 rounded-xl p-5 border border-purple-500/30">
            <h5 class="text-purple-400 font-semibold mb-4 flex items-center gap-2">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
              </svg>
              External SaaS (via Token Vault)
            </h5>
            <ul class="space-y-2 text-sm text-slate-300">
              <li class="flex items-center gap-2"><span class="text-purple-400">•</span> list_calendar_events - Google Calendar</li>
              <li class="flex items-center gap-2"><span class="text-purple-400">•</span> create_calendar_event - Schedule meetings</li>
              <li class="flex items-center gap-2"><span class="text-purple-400">•</span> get_salesforce_contact - CRM data (Phase 2)</li>
            </ul>
          </div>
        </div>

        <!-- Okta Config -->
        <div class="bg-slate-800 rounded-xl p-5 border border-slate-700 mb-6">
          <h4 class="text-sm font-bold text-amber-400 mb-4">Okta Configuration</h4>
          <div class="grid grid-cols-4 gap-4">
            <div>
              <p class="text-xs text-slate-500 mb-1">Agent ID</p>
              <p class="text-sm text-green-400 font-mono">wlpt6vqrvo3HfiGZu1d7</p>
            </div>
            <div>
              <p class="text-xs text-slate-500 mb-1">Auth Server</p>
              <p class="text-sm text-green-400 font-mono">aust6u013gCoEB6sz1d7</p>
            </div>
            <div>
              <p class="text-xs text-slate-500 mb-1">Audience</p>
              <p class="text-sm text-green-400 font-mono">apex-wealth-mcp</p>
            </div>
            <div>
              <p class="text-xs text-slate-500 mb-1">Scopes</p>
              <p class="text-sm text-purple-400 font-mono">mcp:read mcp:write mcp:payment</p>
            </div>
          </div>
        </div>

        <!-- Token Vault Architecture Diagram - Pure SVG exact trace -->
        <div class="bg-white rounded-xl p-4">
          <p class="text-sm font-semibold text-slate-800 mb-1 text-center">Token Vault Architecture: Okta + Auth0</p>
          <p class="text-xs text-slate-500 mb-4 text-center">How Apex accesses Salesforce CRM via Token Vault</p>
          
          <svg viewBox="0 0 1200 520" xmlns="http://www.w3.org/2000/svg" style="width: 100%; height: auto; font-family: system-ui, -apple-system, sans-serif;">
            <defs>
              <marker id="arrow" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
                <polygon points="0 0, 8 3, 0 6" fill="#555"/>
              </marker>
            </defs>

            <!-- OUTER PROTECTS BOUNDARY (large dashed rectangle) -->
            <rect x="55" y="45" width="1090" height="420" fill="none" stroke="#aaa" stroke-width="1" stroke-dasharray="5,3" rx="2"/>
            <text x="600" y="38" text-anchor="middle" fill="#888" font-size="11">Protects</text>

            <!-- TOKEN EXCHANGE BOUNDARY -->
            <rect x="70" y="60" width="810" height="130" fill="none" stroke="#aaa" stroke-width="1" stroke-dasharray="5,3" rx="2"/>
            <text x="475" y="53" text-anchor="middle" fill="#888" font-size="11">Token Exchange</text>

            <!-- ===================== -->
            <!-- WORKFORCE IDENTITY PROVIDER (left) -->
            <!-- ===================== -->
            <rect x="80" y="150" width="160" height="55" fill="#fff" stroke="#333" stroke-width="1.5" rx="3"/>
            <text x="160" y="172" text-anchor="middle" fill="#333" font-size="11" font-weight="600">Workforce Identity Provider</text>
            <text x="160" y="190" text-anchor="middle" fill="#777" font-size="9">https://example.okta.com</text>

            <!-- SSO Labels stacked on right side of IdP box -->
            <text x="265" y="160" fill="#777" font-size="9">SSO (SAML)</text>
            <text x="265" y="190" fill="#777" font-size="9">SSO (OIDC)</text>

            <!-- Main SSO (OIDC) horizontal line to AI Agent -->
            <path d="M 240 177 L 660 177" fill="none" stroke="#555" stroke-width="1" marker-end="url(#arrow)"/>
            <text x="450" y="168" text-anchor="middle" fill="#777" font-size="9">SSO (OIDC)</text>

            <!-- ===================== -->
            <!-- AI AGENT (center top) -->
            <!-- ===================== -->
            <rect x="660" y="145" width="150" height="55" fill="#fff" stroke="#333" stroke-width="1.5" rx="3"/>
            <text x="735" y="168" text-anchor="middle" fill="#333" font-size="11" font-weight="600">AI Agent</text>
            <text x="735" y="186" text-anchor="middle" fill="#777" font-size="9">(id_token, refresh_token)</text>

            <!-- TOKEN EXCHANGE ARC: starts from Agent top, goes up and curves back down into Agent -->
            <path d="M 760 145 L 760 85 L 700 85 L 700 145" fill="none" stroke="#555" stroke-width="1" marker-end="url(#arrow)"/>

            <!-- ===================== -->
            <!-- VERTICAL LINE FROM IDP DOWN -->
            <!-- ===================== -->
            <path d="M 160 205 L 160 385" fill="none" stroke="#555" stroke-width="1"/>

            <!-- Horizontal tick from vertical line to first Auth box -->
            <path d="M 160 280 L 330 280" fill="none" stroke="#555" stroke-width="1" marker-end="url(#arrow)"/>
            <text x="245" y="273" fill="#777" font-size="9">Auth</text>

            <!-- Horizontal tick from vertical line to second Auth box -->
            <path d="M 160 360 L 330 360" fill="none" stroke="#555" stroke-width="1" marker-end="url(#arrow)"/>
            <text x="245" y="353" fill="#777" font-size="9">Auth</text>

            <!-- ===================== -->
            <!-- CUSTOM AUTH SERVER - GITHUB (top) -->
            <!-- ===================== -->
            <rect x="330" y="255" width="200" height="50" fill="#fff" stroke="#333" stroke-width="1" rx="3"/>
            <text x="430" y="275" text-anchor="middle" fill="#333" font-size="10">Custom Authorization Server</text>
            <text x="430" y="292" text-anchor="middle" fill="#777" font-size="9" font-weight="600">Github IdP</text>

            <!-- ===================== -->
            <!-- CUSTOM AUTH SERVER - ATLASSIAN (bottom) -->
            <!-- ===================== -->
            <rect x="330" y="335" width="200" height="50" fill="#fff" stroke="#333" stroke-width="1" rx="3"/>
            <text x="430" y="355" text-anchor="middle" fill="#333" font-size="10">Custom Authorization Server</text>
            <text x="430" y="372" text-anchor="middle" fill="#777" font-size="9" font-weight="600">Atlassian IdP</text>

            <!-- OAuth 2.1 from Github Auth Server - horizontal line -->
            <path d="M 530 280 L 620 280" fill="none" stroke="#555" stroke-width="1"/>
            <text x="575" y="273" text-anchor="middle" fill="#777" font-size="9">OAuth 2.1</text>

            <!-- Connected Account arrow down into Token Vault -->
            <path d="M 700 280 L 700 310" fill="none" stroke="#555" stroke-width="1" marker-end="url(#arrow)"/>
            <text x="755" y="290" fill="#777" font-size="8">Connected Account</text>

            <!-- Horizontal connector from OAuth line to Connected Account line -->
            <path d="M 620 280 L 700 280" fill="none" stroke="#555" stroke-width="1"/>

            <!-- OAuth 2.1 from Atlassian Auth Server -->
            <path d="M 530 360 L 620 360" fill="none" stroke="#555" stroke-width="1"/>
            <text x="575" y="373" fill="#777" font-size="9">OAuth 2.1</text>

            <!-- Connected Account arrow to Token Vault -->
            <path d="M 620 360 L 620 345 L 700 345" fill="none" stroke="#555" stroke-width="1" marker-end="url(#arrow)"/>
            <text x="755" y="355" fill="#777" font-size="8">Connected Account</text>

            <!-- ===================== -->
            <!-- TOKEN VAULT -->
            <!-- ===================== -->
            <rect x="680" y="310" width="170" height="55" fill="#fff" stroke="#333" stroke-width="1.5" rx="3"/>
            <text x="765" y="333" text-anchor="middle" fill="#333" font-size="11" font-weight="600">Token Vault</text>
            <text x="765" y="351" text-anchor="middle" fill="#777" font-size="9">https://example-vault.auth0.com</text>

            <!-- Auth0 Token / Okta Token labels and arrow: from Agent down toward Vault -->
            <path d="M 710 200 L 710 310" fill="none" stroke="#555" stroke-width="1" marker-end="url(#arrow)"/>
            <text x="745" y="235" fill="#777" font-size="8">Auth0 Token</text>
            <text x="745" y="250" fill="#777" font-size="8">Okta Token</text>

            <!-- Vault Stored Token: arrow from Vault up to Agent -->
            <path d="M 780 310 L 780 200" fill="none" stroke="#555" stroke-width="1" marker-end="url(#arrow)"/>
            <text x="820" y="260" fill="#777" font-size="8">Vault Stored Token</text>

            <!-- ===================== -->
            <!-- REQUEST LINES TO RESOURCES (all horizontal from Agent right edge, then 90° down) -->
            <!-- ===================== -->
            
            <!-- Request (Okta Access Token) - straight horizontal to Internal API -->
            <path d="M 810 158 L 1000 158" fill="none" stroke="#555" stroke-width="1" marker-end="url(#arrow)"/>
            <text x="905" y="150" text-anchor="middle" fill="#777" font-size="8">Request (Okta Access Token)</text>

            <!-- Request (Github Access Token) - horizontal then 90° down to Github MCP -->
            <path d="M 810 172 L 940 172 L 940 260 L 1000 260" fill="none" stroke="#555" stroke-width="1" marker-end="url(#arrow)"/>
            <text x="905" y="165" text-anchor="middle" fill="#777" font-size="8">Request (Github Access Token)</text>

            <!-- Request (Atlassian Access Token) - horizontal then 90° down more to Atlassian MCP -->
            <path d="M 810 186 L 920 186 L 920 345 L 1000 345" fill="none" stroke="#555" stroke-width="1" marker-end="url(#arrow)"/>
            <text x="905" y="205" text-anchor="middle" fill="#777" font-size="8">Request (Atlassian Access Token)</text>

            <!-- ===================== -->
            <!-- RESOURCES (right side, stacked vertically) -->
            <!-- ===================== -->
            <rect x="1000" y="133" width="120" height="50" fill="#fff" stroke="#333" stroke-width="1.5" rx="3"/>
            <text x="1060" y="163" text-anchor="middle" fill="#333" font-size="11" font-weight="600">Internal API</text>

            <rect x="1000" y="235" width="120" height="50" fill="#fff" stroke="#333" stroke-width="1.5" rx="3"/>
            <text x="1060" y="265" text-anchor="middle" fill="#333" font-size="11" font-weight="600">Github MCP</text>

            <rect x="1000" y="320" width="120" height="50" fill="#fff" stroke="#333" stroke-width="1.5" rx="3"/>
            <text x="1060" y="350" text-anchor="middle" fill="#333" font-size="11" font-weight="600">Atlassian MCP</text>

            <!-- ===================== -->
            <!-- BOTTOM PROTECTS LINES (L-shaped dashed lines from Vault area) -->
            <!-- ===================== -->
            <path d="M 680 390 L 680 430 L 970 430" fill="none" stroke="#aaa" stroke-width="1" stroke-dasharray="5,3"/>
            <text x="825" y="445" text-anchor="middle" fill="#888" font-size="9">Protects</text>

            <path d="M 680 410 L 680 465 L 1070 465" fill="none" stroke="#aaa" stroke-width="1" stroke-dasharray="5,3"/>
            <text x="875" y="480" text-anchor="middle" fill="#888" font-size="9">Protects</text>

          </svg>
        </div>
      </div>
    </div>

  </main>

  <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
    // Initialize Mermaid
    mermaid.initialize({ 
      startOnLoad: true, 
      theme: 'base',
      themeVariables: {
        primaryColor: '#3b82f6',
        primaryTextColor: '#1e293b',
        primaryBorderColor: '#1e40af',
        lineColor: '#64748b',
        secondaryColor: '#f59e0b',
        tertiaryColor: '#10b981',
        background: '#ffffff',
        noteBkgColor: '#fef3c7',
        noteTextColor: '#1e293b',
      }
    });

    function toggleSection(id) {
      var content = document.getElementById(id + '-content');
      var chevron = document.getElementById(id + '-chevron');
      if (content && chevron) {
        if (content.classList.contains('hidden')) {
          content.classList.remove('hidden');
          chevron.classList.add('rotate-180');
        } else {
          content.classList.add('hidden');
          chevron.classList.remove('rotate-180');
        }
      }
    }

    function expandAll() {
      var sections = ['section1